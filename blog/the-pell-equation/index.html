<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">

  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>
    
      Solving The Pell Equation Efficently &middot; Eric Keilty
    
  </title>

  <!-- CSS -->
  <link rel="stylesheet" href=/public/css/poole.css>
  <link rel="stylesheet" href=/public/css/syntax.css>
  <link rel="stylesheet" href=/public/css/hyde.css>
  <link rel="stylesheet" href=/public/css/custom.css>
  <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=PT+Sans:400,400italic,700|Abril+Fatface">
  <link rel="stylesheet" href="https://netdna.bootstrapcdn.com/font-awesome/4.0.1/css/font-awesome.min.css">

  <!-- Icon -->
  <link rel="apple-touch-icon" sizes="180x180" href=/public/favicon/terminal/apple-touch-icon.png>
  <link rel="icon" type="image/png" sizes="32x32" href=/public/favicon/terminal/favicon-32x32.png>
  <link rel="icon" type="image/png" sizes="16x16" href=/public/favicon/terminal/favicon-16x16.png>
  <link rel="manifest" href=/public/favicon/terminal/site.webmanifest>
  <link rel="mask-icon" href=/public/favicon/terminal/safari-pinned-tab.svg color="#5bbad5">
  <link rel="short icon" href=/public/favicon/terminal/favicon.ico>
  <meta name="msapplication-TileColor" content="#da532c">
  <meta name="msapplication-config" content=/public/favicon/browserconfig.xml>
  <meta name="theme-color" content="#ffffff">

  <!-- RSS 
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">-->
</head>
  <!-- Enable embedded MathJax (effectively LaTeX) support 
    https://docs.mathjax.org/en/v2.7-latest/tex.html -->
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        jax: ["input/TeX", "input/MathML", "output/SVG", "output/CommonHTML"],
        extensions: ["tex2jax.js", "mml2jax.js", "MathMenu.js", "MathZoom.js", "CHTML-preview.js"],
        TeX: {
            extensions: ["AMSmath.js", "AMSsymbols.js", "noErrors.js", "noUndefined.js", "cancel.js"],
            Macros: {
                b: ["{\\boldsymbol #1}",1],
                u: ["{\\hat{\\boldsymbol #1}}",1],
                m: ["[ \\, #1 \\, ]",1],
                arccsc: ["\\operatorname\{arccsc\}"],
                arcsec: ["\\operatorname\{arcsec\}"],
                arccot: ["\\operatorname\{arccot\}"],
                csch: ["\\operatorname\{csch\}"],
                sech: ["\\operatorname\{sech\}"],
                arcsinh: ["\\operatorname\{arcsinh\}"],
                arccosh: ["\\operatorname\{arccosh\}"],
                arctanh: ["\\operatorname\{arctanh\}"],
                arccsch: ["\\operatorname\{arccsch\}"],
                arcsech: ["\\operatorname\{arcsech\}"],
                arccoth: ["\\operatorname\{arccoth\}"],
                seq: ["{\\left \\langle #1 \\right \\rangle}",1],
                iseq: ["{\\left \\langle #1 \\right \\rangle_{#2 = 0}^{\\infty}}",2],
                abs: ["{\\left \\lvert #1 \\right \\rvert}",1],
                hal: ["\\texttt{hal}"],
                gal: ["\\texttt{gal}"],
                sh: ["sh"],
                st: ["st"]
            },
        },
        tex2jax: {
            inlineMath: [ ['$','$'], ["\\(","\\)"] ],
            displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
            processEscapes: true,
            processEnvironments: true
        },
        "HTML-CSS": { availableFonts: ["TeX"] }
    });
</script>

<script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML-full"></script>

<!--
    TeX-AMS_HTML
    TeX-AMS-MML_HTMLorMML
    TeX-MML-AM_HTMLorMML
-->

  <body>
    
    <div class="sidebar">
    <div class="container">
      <!--
      <img src="/assets/mandlebrot-set.jpg" class="responsive"  height="220">
      -->
      
      <div class="sidebar-about">
        <h1>Eric Keilty</h1>
        <p class="lead">AI/ML Engineer</p>
      </div>
    </div>
    
    <div class="container sidebar-sticky">
      <ul class="sidebar-nav">

        <li class="sidebar-nav-item">
            <a href="/">Home</a>
        </li>
        
        
          <li class="sidebar-nav-item">
            <a href="/about">About</a>
          </li>
        
          <li class="sidebar-nav-item">
            <a href="/blog">Blog</a>
          </li>
        
        <li>
          <a href="/files/Eric Keilty - Resume.pdf" target="_blank">R&eacute;sum&eacute;</a>
        </li>

        <!-- <li class="sidebar-nav-item"><a href="">Curriculum Vitae</a></li> -->
        <!-- <li class="sidebar-nav-item">Currently v1.0.0</li> -->
      </ul>
      
      <div id="social">
        <div id="social">
    
  <a title="Me on Github" href="https://github.com/ekeilty17">
    <i class="fa fa-github-square fa-2x"></i>
    <i>&ensp;</i>
  </a>

  <a title="Me on LinkedIn" href="https://www.linkedin.com/in/ekeilty/">
    <i class="fa fa-linkedin fa-2x"></i>
    <i>&ensp;</i>
  </a>
  
  <a title="Email me" href="mailto:epkeilty@gmail.com">
    <i class="fa fa-envelope fa-2x"></i>
  </a>
  
</div>
      </div>
      <p>&copy; 2024 Eric Keilty </p>

    </div>
  </div>

    <div class="content container">

        <div class="post">
            <h1 class="post-title">Solving The Pell Equation Efficently</h1>
            <!-- <span class="post-date">01 Aug 2022</span> -->
            <time datetime="2022-08-01T00:00:00-04:00" class="post-date">01 Aug 2022</time>
            <p>The Pell Equation is an equation of the form $x^2 - D y^2 = 1$ for $D &gt; 0$. Our task is to find <strong>integer</strong> solutions to this equation. I was first introduced to this problem by <a href="https://projecteuler.net/problem=66">Project Euler #66</a>, and I think the solution is beautiful and would like to share it. Much of this post is inspired by <a href="http://library.msri.org/books/Book44/files/01lenstra.pdf">this paper</a> by Hendrik W. Lenstra, Jr.</p>

<p><br /></p>

<h2 id="reframing-the-problem">Reframing the Problem</h2>

<p>First, we note two key facts:</p>

<ul>
  <li>$\mathbb{Z}[\sqrt{D}] =$ { $x + \sqrt{D} y \ \ \vert \ \ x, y \in \mathbb{Z}$ } forms a <strong>ring</strong> on operations addition and multiplication</li>
  <li>$\vert x + \sqrt{D} y \vert = x^2 - D y^2$ is a <strong>norm</strong> of this ring</li>
</ul>

<p>Both of these claims will be proved in an appendix at the end of the post for completeness’ sake, but these details are not the focus. What is important is that we notice the Pell Equation can be factored as the following.</p>

\[(x + \sqrt{D} y) (x - \sqrt{D} y) = 1\]

<p>Thus, we can reframe finding the solutions to the Pell Equation as finding the <strong>nontrivial</strong> unit of the ring $\mathbb{Z}[\sqrt{D}]$ of norm 1.</p>

<p>This gives us a way of generating new solutions from a given solution. Suppose that $(x_1, y_1)$ is a solution to the Pell Equation. We notice that</p>

<div class="equation-container">
$$
\vert x_1 + \sqrt{D} y_1 \vert = 1 \implies \vert x_1 + \sqrt{D} y_1 \vert^k = 1 \quad \text{for all} \ k \geq 1
$$
</div>

<p>Using properties of norms, we have</p>

<div class="equation-container">
$$
\vert x_1 + \sqrt{D} y_1 \vert^k = \vert (x_1 + \sqrt{D} y_1)^k \vert
$$
</div>

<p>Since $\mathbb{Z}[\sqrt{D}]$ forms a ring, $(x_1 + \sqrt{D} y_1)^k = x_k + \sqrt{D} y_k$ for some $x_k, y_k \in \mathbb{Z}$. Putting it all together we have</p>

<div class="equation-container">
$$
\vert x_1 + \sqrt{D} y_1 \vert = 1 \implies 1 = \vert x_1 + \sqrt{D} y_1 \vert^k = \vert (x_1 + \sqrt{D} y_1)^k \vert = \vert x_k + \sqrt{D} y_k \vert = x_k^2 - D y_k^2
$$
</div>

<p>Thus, $(x_k, y_k)$ is also a solution to the Pell Equation for all $k \geq 1$.
In fact, <a href="https://faculty.math.illinois.edu/~r-ash/Ant/AntChapter6.pdf">Dirichlet’s Unit Theorem</a> tells us that given $(x_1, y_1)$ is the <strong>fundamental solution</strong> to the Pell Equation, this method will generate <strong>every</strong> solution. The fundamental solution is the <strong>nontrivial</strong> solution with the smallest $x$ or $y$ component.</p>

<p>So once we have the fundamental solution, we have a <em>very</em> efficient algorithm for generating the remaining solutions. if $(x_1, y_1)$ is the fundamental solution, then</p>

<div class="equation-container">
$$
(x_{k+1} - \sqrt{D} y_{k+1}) = (x_1 - \sqrt{D} y_1)^{k+1} = (x_1 - \sqrt{D} y_1) \cdot (x_1 - \sqrt{D} y_1)^k = (x_1 - \sqrt{D} y_1) \cdot (x_k - \sqrt{D} y_k)
$$
</div>

<p>Multiplying out the far right-hand side and equating it to the far left-hand side gives the recursive identity</p>

<div class="equation-container">
$$
(x_{k+1}, y_{k+1}) = (x_1 x_k + D y_1 y_k, x_1 y_k + x_k y_1)
$$
</div>

<p>Note that $(1, 0)$ is considered a trivial solution. If we attempt to use the recursive formula defined above, we will see that we just get $(1, 0)$ back. Thus, this is not a fundamental solution.</p>

<p><br /></p>

<h2 id="continued-fractions">Continued Fractions</h2>

<p>We have to take a quick detour into continued fractions as they play an important role in the solution. A continued fraction takes the form</p>

\[a_0 + \frac{1}{a_1 + \frac{1}{a_2 + \frac{1}{a_3 + \ldots}}}\]

<p>I think they are best explained by an example.</p>

<div class="equation-container">
$$
\sqrt{3} = 1 + (\sqrt{3} - 1) = 3 + \frac{2}{\sqrt{3} + 1} = 3 + \frac{1}{\frac{\sqrt{3} + 1}{2}} = 3 + \frac{1}{1 + \frac{\sqrt{3} - 1}{2}} = 3 + \frac{1}{1 + \frac{1}{\sqrt{3} + 1}} = 3 + \frac{1}{1 + \frac{1}{2 + (\sqrt{3} - 1)}}
$$
</div>

<p>Notice in the last part, we arrived at the same expression as when we started: $\sqrt{3} - 1$. Therefore, everything after that point will be exactly the same, so we’ve arrived at a repeating expression. If a continued fraction has this property, it is called <strong>periodic</strong>. It turns out that $\sqrt{n}$ where $n$ is an integer is always periodic. The proof for this could be its own post. For the curious refer <a href="https://sites.millersville.edu/bikenaga/number-theory/periodic-continued-fractions/periodic-continued-fractions.html">here</a>. Thus, we can write the continued fraction in a sort-hand notation.</p>

<div class="equation-container">
$$
\sqrt{3} = 1 + \frac{1}{1 + \frac{1}{2 + \frac{1}{1 + \frac{1}{2 + \ldots}}}} = [1; 1, 2, 1, 2, \ldots] = [1; \overline{1, 2}]
$$
</div>

<p><br /></p>

<h2 id="finding-the-fundamental-solution">Finding the Fundamental Solution</h2>

<p>This part of the solution is the reason I needed to share this problem. It is so shocking, yet so beautiful.</p>

<p>It turns out, the fundamental solution can be calculated by the following procedure</p>

<ol>
  <li>Compute the continued fraction of \(\sqrt{D}\), suppose it has the form \([a_0; \overline{a_1, \ldots, a_k}]\)</li>
  <li>
    <p>Compute the following truncated continued fraction</p>

    <div class="equation-container">
 $$ 
 \frac{x}{y} = \begin{cases}
     [a_0; a_1, \ldots, a_{k-1}] \quad &amp;\text{if } k \text{ is even} \\
     [a_0; a_1, \ldots, a_{2k-1}] \quad &amp;\text{if } k \text{ is odd}
 \end{cases}
 $$
 </div>
  </li>
  <li>\((x, y)\) is the fundamental solution, i.e. \(x^2 - D y^2 = 1\).</li>
</ol>

<p>A different but equivalent approach (more practical for code) is the following:</p>

<ol>
  <li>Compute the continued fraction of \(\sqrt{D}\), suppose it has the form \([a_0; \overline{a_1, \ldots, a_k}]\)</li>
  <li>Compute the following truncated continued fraction \(\frac{x}{y} = [a_0; a_1, \ldots, a_k]\)</li>
  <li>Evaluate \(x^2 - D y^2\). If it equals $-1$, then square the solution (\(x' = x^2 + Dy^2, y' = 2xy\)) and that is the fundamental solution.</li>
</ol>

<p><br /></p>

<p>Let’s do an example using \(\sqrt{3}\). The truncated continued fraction and its reduced fraction form is the following</p>

<div class="equation-container">
$$
\sqrt{3} = 3 + \frac{1}{1 + \frac{1}{2 + (\sqrt{3} - 1)}} \quad\rightarrow\quad 1 + \frac{1}{1 + 0} = \frac{2}{1}
$$
</div>

<p>Now, we test the solution \((x, y) = (2, 1)\).</p>

\[2^2 - 3 \cdot 1^2 = 4 - 3 = 1\]

<p>And indeed, it’s the fundamental solution. This can be used to generate every solution extremely efficiently.</p>

\[(x_{k+1}, y_{k+1}) = (2 x_k + 3 y_k, x_k + 2 y_k)\]

<h3 id="why-does-that-work">Why Does That Work?</h3>

<p>Intuitively, the reason this works is because the continued fraction is a very good approximation \(\sqrt{D}\). By truncating it at its periodic point, we take advantage of a number of properties which ensures it’s an extremely good approximation. Thus, when we run it through the Pell Equation, we only get a difference of \(1\).</p>

<p>To add a bit more detail, I am going to give a proof sketch. For a complete proof, you can refer <a href="https://ir.canterbury.ac.nz/server/api/core/bitstreams/7f14fb64-bc37-46b8-9d2d-0d705cab0319/content">here</a>.</p>

<p>Let continued fraction of \(\sqrt{D}\) be \([a_0; \overline{a_1, \ldots, a_k}]\). Let \(p_n / q_n = [a_0; a_1, \ldots, a_n]\) denote the \(n\)th truncation of the continued fraction. I am going to assert the following equality (you can check it yourself).</p>

<div class="equation-container">
$$
\sqrt{D} = \frac{(a_0 + \sqrt{D}) p_{k-1} + p_{k-2}}{(a_0 + \sqrt{D})q_{k-1} + q_{k-2}}
$$
</div>

<p>Expanding, we get</p>

<div class="equation-container">
$$
q_{k-1} D + (a_0 q_{k-1} + q_{k-2})\sqrt{D} = a_0 p_{k-1} + p_{k-2} + p_{k-1} \sqrt{D}
$$
</div>

<p>Since $\mathbb{Z}[\sqrt{D}]$ is a field, we have</p>

<div class="equation-container">
$$
q_{k-1} D = a_0 p_{k-1} + p_{k-2} \qquad\text{and}\qquad p_{k-1} = a_0 q_{k-1} + q_{k-2}
$$
</div>

<p>Therefore</p>

<div class="equation-container">
$$
p_{k-2} = q_{k-1} D - a_0 p_{k-1} \qquad\text{and}\qquad q_{k-2} = p_{k-1} - a_0 q_{k-1}
$$
</div>

<p>Another fact I will state without proof is that $p_{i+1}q_i - p_iq_{i+1} = (-1)^i$ for any $i$. This is not too difficult to verify for yourself using induction. Now, substitute $i = k-2$ and combine with the above to get</p>

<div class="equation-container">
$$
(-1)^{k-2} = p_{k-1}(p_{k-1} - a_0 q_{k-1}) - (q_{k-1} D - a_0 p_{k-1})q_{k-1}
$$
</div>

<p>Thus,</p>

<div class="equation-container">
$$
p_{k-1}^2 - D q_{k-1}^2 = (-1)^k
$$
</div>

<p>i.e. $(p_{k-1}, q_{k-1})$ is a solution to the Pell Equation if $k$ is even. You can use exactly the same argument to find that $(p_{2k-1}, q_{2k-1})$ is a solution if $k$ is odd.</p>

<p>A detail I have left out is why this gives the <em>fundamental</em> solution. Intuitively this is because $[a_0; a_1, \ldots, a_{k-1}]$ is the first truncation that gives a solution. Therefore, it will result in the smallest resulting solution. To prove this formally is too much math for an already long post.</p>

<p><br /></p>

<h2 id="implementation">Implementation</h2>

<p>All this theory provides an extremely simple, elegant, and efficient algorithm for solving the Pell Equation. The pseudocode is given below. I have also implemented this fully on my <a href="https://github.com/ekeilty17/Project_Euler/blob/master/P066.py">GitHub</a>.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">fundamental_solution_of_pell_equation</span><span class="p">(</span><span class="n">D</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">is_perfect_square</span><span class="p">(</span><span class="n">D</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">None</span>     <span class="c1"># perfect squares have no solution
</span>
    <span class="n">L</span> <span class="o">=</span> <span class="n">continued_fraction</span><span class="p">(</span><span class="n">D</span><span class="p">)</span>      <span class="c1"># [a_0, a_1, ..., a_k]
</span>    <span class="n">x0</span><span class="p">,</span> <span class="n">y0</span> <span class="o">=</span> <span class="n">collapse_continued_fraction</span><span class="p">(</span><span class="n">L</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">x0</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">D</span> <span class="o">*</span> <span class="n">y0</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
        <span class="n">x0</span><span class="p">,</span> <span class="n">y0</span> <span class="o">=</span> <span class="n">x0</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">D</span><span class="o">*</span><span class="n">y0</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">x0</span><span class="o">*</span><span class="n">y0</span>
    
    <span class="k">return</span> <span class="n">x0</span><span class="p">,</span> <span class="n">y0</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">generate_kth_solution</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">x0</span><span class="p">,</span> <span class="n">y0</span>
    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">k</span><span class="p">):</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">x0</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">D</span><span class="o">*</span><span class="n">y0</span><span class="o">*</span><span class="n">y</span><span class="p">,</span> <span class="n">x0</span><span class="o">*</span><span class="n">y</span> <span class="o">+</span> <span class="n">x</span><span class="o">*</span><span class="n">y0</span>
    <span class="k">return</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span>
</code></pre></div></div>

<p>There are faster algorithms than this, but the theory behind them is much beyond me.</p>

<p><br /></p>

<hr />

<h2 id="appendix">Appendix</h2>

<h3 id="mathbbzsqrtd-forms-a-ring-on-addition-and-multiplication">$\mathbb{Z}[\sqrt{D}]$ Forms a Ring on Addition and Multiplication</h3>

<p>We define the operations $+$ and $\cdot$ as you would expect. Let $(a, b)$ be short-hand for $a + \sqrt{D}b$</p>

<div class="equation-container">
$$
(a, b) + (c, d) = (a+c, \ b+d) \qquad \text{and} \qquad (a, b) \cdot (c, d) = (ac + Dbd, \ ad + bc)
$$
</div>

<p>The ring axioms are as follows</p>
<ol>
  <li>Addition is associative</li>
  <li>Addition is commutative</li>
  <li>$\mathbb{Z}[\sqrt{D}]$ contains the additive identity</li>
  <li>$\mathbb{Z}[\sqrt{D}]$ contains the additive inverse for all elements</li>
  <li>Multiplication is associative</li>
  <li>$\mathbb{Z}[\sqrt{D}]$ contians the multiplicative identity</li>
  <li>Multiplication is distributive with respect to addition, i.e. $\ a \cdot (b + c) = (a \cdot b) + (a \cdot c)$ and $\ (b + c) \cdot a = (b \cdot a) + (c \cdot a)$</li>
</ol>

<p>Axioms 1, 2, 3, and 4 are inherited from their counterparts for the integers.</p>

<p>$1.$</p>

<div class="equation-container">
$$ 
\begin{align}
    ((a, b) + (c, d)) + (e, f) 
    &amp;= (a+c, \ b+d) + (e, f) \\
    &amp;= ((a+c)+e, \ (b+d)+f) \\
    &amp;= (a+(c+e), \ b+(d+f)) \\
    &amp;= (a, b) + ((c, d) + (e, f)) 
\end{align}
$$
</div>

<p>$2.$</p>

<div class="equation-container">
$$ (a, b) + (c, d) = (a+c, \ b+d) = (c+a, \ d+b) = (c, d) + (a, b) $$
</div>

<p>$3.$ The additive identity is $(0, 0)$, which is contained in $\mathbb{Z}[\sqrt{D}]$</p>

<div class="equation-container">
$$ (a, b) + (0, 0) = (a+0, \ b+0) = (a, b) $$
</div>

<p>$4.$ The additive inverse is $(-a, -b)$, which is contained in $\mathbb{Z}[\sqrt{D}]$</p>

<div class="equation-container">
$$ (a, b) + (-a, -b) = (a+(-a), \ b+(-b)) = (0, 0) $$
</div>

<p>Axioms 5, 6, and 7 are inherited by the fact that the integers form a ring.</p>

<p>$5.$</p>

<div class="equation-container">
$$ 
\begin{align}
    ((a, b) \cdot (c, d)) \cdot (e, f) 
    &amp;= (ac + Dbd, \ ad + bc) + (e, f) \\
    &amp;= ((ac + Dbd)e + D(ad + bc)f , \ (ac + Dbd)f + (ad + bc)e ) \\
    &amp;= (a(ce + Ddf) + Db(cf + de) , \ a(cf + de) + b(ce + Ddf) ) \\
    &amp;= (a, b) \cdot (ce + Ddf, cf + de) \\
    &amp;= (a, b) \cdot ((c, d) \cdot (e, f))
\end{align}
$$
</div>

<p>$6.$ The multiplicative identity is $(1, 0)$, which is contained in $\mathbb{Z}[\sqrt{D}]$</p>

<div class="equation-container">
$$ (a, b) \cdot (1, 0) = (a \cdot 1 + Db \cdot 0, \ a \cdot 0 + b \cdot 1) = (a, b)$$
</div>

<p>$7.$</p>

<div class="equation-container">
$$
\begin{align}
    (a, b) \cdot ((c, d) + (e, f))
    &amp;= (a, b) \cdot (c+e, \ d+f) \\
    &amp;= (a(c+e) + Db(d+f), \ a(d+f) + b(c+e)) \\
    &amp;= (ae + Dbf, \ af + be) + (ce + Ddf, \ cf + de) \\
    &amp;= ((a, b) \cdot (e, f)) + ((c, d) \cdot (e, f))
\end{align}
$$
</div>

<p>We can see that in this case, multiplication is actually also commutative</p>

<div class="equation-container">
$$ (a, b) \cdot (c, d) = (ac + Dbd, \ ad + bc) = (ca + Ddb, \ cb + da) = (c, d) \cdot (a, b)$$
</div>

<p>So we get</p>

<div class="equation-container">
$$((c, d) + (e, f)) \cdot (a, b) = (a, b) \cdot ((c, d) + (e, f)) = ((a, b) \cdot (e, f)) + ((c, d) \cdot (e, f))$$
</div>

<p>for free.</p>

<p><br /></p>

<h3 id="vert-x--sqrtd-y-vert--x2---d-y2-is-a-multiplicative-norm-of-this-ring">$\vert x + \sqrt{D} y \vert = x^2 - D y^2$ is a Multiplicative Norm of this Ring</h3>

<p>The axioms of a multiplicative norm $N(x)$ on a ring is the following:</p>
<ol>
  <li>$N(u) = 0 \iff u = 0 + \sqrt{d} \cdot 0$</li>
  <li>$N(u \cdot v) = N(u) N(v) \quad \text{for all} \ u, v \in \mathbb{Z}[\sqrt{D}]$</li>
  <li>$N(u + v) = N(u) + N(v) \quad \text{for all} \ u, v \in \mathbb{Z}[\sqrt{D}]$</li>
</ol>

<p>$1.$</p>

<div class="equation-container">
$$
\vert u \vert = 0 \iff \vert x_u + \sqrt{D} y_u \vert = 0 \iff x_u^2 + D y_u^2 = 0 \iff x_u = y_u = 0 \iff u = 0 + \sqrt{d} \cdot 0
$$
</div>

<p>$2.$</p>

<div class="equation-container">
$$
\begin{align}
    \vert u \cdot v \vert 
    &amp;= \vert (x_u - \sqrt{D} y_u) \cdot (x_v - \sqrt{D} y_v) \vert \\
    &amp;= \vert (x_u x_v + D y_u y_v) - \sqrt{D} ( x_u y_v + x_v y_u )  \vert \\
    &amp;= (x_u x_v + D y_u y_v)^2 - D ( x_u y_v + x_v y_u )^2 \\
    &amp;= (x_u^2 x_v^2 + D^2 y_u^2 y_v^2 + 2 D x_u x_v y_u y_v) - D ( x_u^2 y_v^2 + x_v^2 y_u^2 + 2 x_u x_v y_u y_v ) \\
    &amp;= x_u^2 x_v^2 + D^2 y_u^2 y_v^2 - D x_u^2 y_v^2 - D x_v^2 y_u^2 \\
    &amp;= (x_u^2 - D y_u^2) (x_v^2 - D y_v^2) \\
    &amp;= \vert u \vert \vert v \vert
\end{align}
$$
</div>

<p>$3.$</p>

<div class="equation-container">
$$
\begin{align}
    \vert u \cdot v \vert 
    &amp;= \vert (x_u - \sqrt{D} y_u) + (x_v - \sqrt{D} y_v) \vert \\
    &amp;= \vert (x_u + x_v) - \sqrt{D} (y_u + y_v) \vert \\
    &amp;= (x_u + x_v)^2 - D (y_u + y_v)^2 \\
    &amp;= (x_u^2 + x_v^2 + 2 x_u x_v) - D (y_u^2 + y_v^2 + 2 y_u y_v) \\
    &amp;= (x_u^2 + x_v^2 + 2 x_u x_v) - D (y_u^2 + y_v^2 + 2 y_u y_v) \\
\end{align}
$$
</div>


        </div>
    </div>

    <!--
    <h3 style="text-align:center; margin-bottom:1em;">
      <a href="/blog/">Blog Archive</a>
    </h3>
    -->
    
  </body>
</html>